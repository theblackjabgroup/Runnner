{% if section.settings.enabled %}
  {% if section.settings.color_scheme %}
    {% assign section_classes_fc = section_classes_fc | append: ' color-' | append: section.settings.color_scheme %}
  {% endif %}
  <div
    class="featured-collection-page-width overflow-hidden {{section_classes_fc}}"
    role="region"
    aria-labelledby="featured-collection-heading"
    aria-describedby="featured-collection-description"
  >
    {% if section.settings.heading != blank %}
      <div
        style="font-weight:500; color: var(--text);"
        class="featured-collection-main-heading mb-[-10px]{% if section.settings.enable_letter_animation %} letter-animation{% endif %}"
      >
        {{ section.settings.heading }}
      </div>
    {% endif %}

    <div
      class="flex justify-between items-start w-full featured-collection-subheading"
      style="padding-top: 10px; color: var(--text);"
    >
      <div class="flex-grow md:text-[24px] text-2xl md:mt-[-20px]">
        {% if section.settings.description != blank %}
          {{ section.settings.description }}
        {% endif %}
      </div>
      <div class="flex-shrink-0">
        {% if section.settings.show_shop_all and section.settings.main_collection %}
          <a
            href="{{ section.settings.main_collection.url }}"
            class="featured-collection-custom-button"
            aria-label="{{ section.settings.button_text }} for {{ section.settings.main_collection.title }}"
          >
            <div class="featured-collection-button-text-container">
              <div class="featured-collection-button-text">
                {{ section.settings.button_text }}
                {% comment %}
                  <span class="featured-collection-button-arrow">
                    <svg width="28" height="36" viewBox="0 0 38 36" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5">
                      <path fill="currentColor" d="M26.79,9.21A35.06,35.06,0,0,0,37,16.2v3.66a35.34,35.34,0,0,0-10.21,7A12.84,12.84,0,0,0,23.21,36H17.56q0-6.22,3-10a15.4,15.4,0,0,1,8.06-5.2V20.6H0V15.43H28.63v-.3A15.16,15.16,0,0,1,20.57,10q-3-3.77-3-10h5.65a13,13,0,0,0,.87,5A12.79,12.79,0,0,0,26.79,9.21Z"/>
                    </svg>
                  </span>
                {% endcomment %}
              </div>
              <div class="featured-collection-button-text-hover">
                {{ section.settings.button_text }}
                {% comment %}
                  <span class="featured-collection-button-arrow">
                    <svg width="28" height="36" viewBox="0 0 38 36" xmlns="http://www.w3.org/2000/svg" class="w-5 h-5">
                      <path fill="currentColor" d="M26.79,9.21A35.06,35.06,0,0,0,37,16.2v3.66a35.34,35.34,0,0,0-10.21,7A12.84,12.84,0,0,0,23.21,36H17.56q0-6.22,3-10a15.4,15.4,0,0,1,8.06-5.2V20.6H0V15.43H28.63v-.3A15.16,15.16,0,0,1,20.57,10q-3-3.77-3-10h5.65a13,13,0,0,0,.87,5A12.79,12.79,0,0,0,26.79,9.21Z"/>
                    </svg>
                  </span>
                {% endcomment %}
              </div>
            </div>
          </a>
        {% endif %}
      </div>
    </div>

    <hr class="border-(--text) my-6" aria-hidden="true">

    <div class="featured_collection_filters flex flex-col md:flex-row mt-10" style="gap:18px; margin-top:18px;">
      <nav
        class="collections-container text-[24px] w-full md:w-[400px] min-w-[350px] order-1 md:order-none mb-4 md:mb-0"
        aria-label="Collection filters"
      >
        <div class="collection-filters flex flex-row md:flex-col flex-wrap" role="tablist" aria-label="Collections">
          {% for block in section.blocks %}
            {% if block.settings.collection == blank %}
              {% assign button_collection_id = 'blank-' | append: block.id %}
            {% else %}
              {% assign button_collection_id = block.settings.collection.id %}
            {% endif %}

            <button
              class="collection-btn {% if forloop.first %}active{% endif %} w-auto md:w-full h-[54px] flex items-center justify-between"
              role="tab"
              aria-selected="{% if forloop.first %}true{% else %}false{% endif %}"
              tabindex="{% if forloop.first %}0{% else %}-1{% endif %}"
              type="button"
              data-collection="{{ button_collection_id }}"
            >
              <span class="label-text">{{ block.settings.label }}</span>
              {% comment %}
                <svg class="svg-arrow-right" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 37 36" width="18" height="18">
                  <path fill="currentColor" d="M26.79,9.21A35.06,35.06,0,0,0,37,16.2v3.66a35.34,35.34,0,0,0-10.21,7A12.84,12.84,0,0,0,23.21,36H17.56q0-6.22,3-10a15.4,15.4,0,0,1,8.06-5.2V20.6H0V15.43H28.63v-.3A15.16,15.16,0,0,1,20.57,10q-3-3.77-3-10h5.65a13,13,0,0,0,.87,5A12.79,12.79,0,0,0,26.79,9.21Z"/>
                </svg>
              {% endcomment %}
              {% comment %}
                <img
                  src="{{ "arrow-down.png" | asset_url }}"
                  alt="Dropdown Icon"
                  class="w-12 h-6 object-contain transition-transform duration-300 group-hover:-rotate-90 collection-arrow-img"
                  width="100%"
                  height="auto"
                  aria-hidden="true"
                >
              {% endcomment %}
              <div
                class="object-contain transition-transform duration-300 group-hover:-rotate-90 fc-arrow-img"
                alt="Dropdown Icon"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="featured-collection-arrow-svg w-5 h-5 object-contain transition-transform duration-300 ease-in-out group-hover:-rotate-90 mx-1 {% if section.settings.arrow_on_hover %} featured-collection-arrow-svg-only-on-hover{% endif %}"
                  fill="none"
                  viewBox="0 0 9 9"
                  stroke-width="1.5"
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  aria-hidden="true"
                >
                  <path d="M1.1875 7.7334H7.6599M7.6599 7.7334V1.261M7.6599 7.7334L1.1875 1.261"/>
                </svg>
                {% comment %}
                  <svg
                    class="featured-collection-arrow-svg transition-transform duration-200 ease-in-out"
                    xmlns="http://www.w3.org/2000/svg"
                    width="25px"
                    height="25px"
                    stroke-width="10"
                    viewBox="0 0 20 20"
                  >
                    <g transform="rotate(270 12 12)">
                      <path fill="currentColor" d="M1.1875 7.7334H7.6599M7.6599 7.7334V1.261M7.6599 7.7334L1.1875 1.261"></path>
                    </g>
                  </svg>
                {% endcomment %}
              </div>
            </button>
          {% endfor %}
        </div>
      </nav>

      <main class="products-container w-full md:flex-1 order-2 md:order-none">
        {% comment %} Create array of unique collection IDs to prevent duplicates {% endcomment %}
        {% assign unique_collections = '' %}
        {% assign processed_collection_ids = '' %}

        {% for block in section.blocks %}
          {% if block.settings.collection == blank %}
            {% assign collection_id = 'blank-' | append: block.id %}
          {% else %}
            {% assign collection_id = block.settings.collection.id | append: '' %}
          {% endif %}

          {% unless processed_collection_ids contains collection_id %}
            {% assign unique_collections = unique_collections | append: block.id | append: ',' %}
            {% assign processed_collection_ids = processed_collection_ids | append: collection_id | append: ',' %}
          {% endunless %}
        {% endfor %}

        {% assign unique_collections_array = unique_collections | split: ',' %}

        {% for block in section.blocks %}
          {% assign block_id_string = block.id | append: '' %}
          {% if unique_collections_array contains block_id_string %}
            {% if block.settings.collection == blank %}
              {% assign container_collection_id = 'blank-' | append: block.id %}
            {% else %}
              {% assign container_collection_id = block.settings.collection.id %}
            {% endif %}

            <div
              class="collection-products-container {% unless forloop.first %}hidden{% endunless %}"
              data-collection-id="{{ container_collection_id }}"
              role="tabpanel"
              aria-labelledby="tab-{{ container_collection_id }}"
              tabindex="0"
            >
              <div class="slider-container relative">
                <div
                  id="product-slider-{{ container_collection_id }}"
                  class="product-slider flex gap-2 md:gap-4 cursor-grab overflow-x-auto custom-scrollbar"
                  role="list"
                  aria-label="Products in {{ block.settings.label }}"
                >
                  {% if block.settings.collection == blank or block.settings.collection.products.size == 0 %}
                    {% for i in (1..5) %}
                      <article
                        class="product-card flex-none"
                        role="listitem"
                        aria-label="No products found"
                      >
                        <div class="product-image-wrapper relative group" aria-hidden="true">
                          {{ 'collection-1' | placeholder_svg_tag }}
                        </div>
                        <div class="product-details mt-3" style="margin-bottom:8px;">
                          <h3 class="uppercase font-medium leading-tight">No products found</h3>
                          <div class="flex gap-2 items-baseline fc-price" style="margin-top: -6px;">
                            <span class="!text-[1.6rem] uppercase font-medium">â€”</span>
                          </div>
                        </div>
                      </article>
                    {% endfor %}
                  {% else %}
                    {% for product in block.settings.collection.products %}
                      <article
                        class="product-card flex-none"
                        role="listitem"
                        aria-label="{{ product.title }}"
                      >
                        <div class="product-image-wrapper relative group">
                          {% unless product.available %}
                            <div class="absolute top-3 right-4 z-2">
                              <span
                                class="tracking-wide font-medium bg-zinc-800 sold-out"
                                style="background-color: rgb(var(--color-background)); color: var(--text);"
                              >
                                SOLD OUT
                              </span>
                            </div>
                          {% endunless %}

                          <a
                            href="{{ product.url }}"
                            class="product-image-link block relative"
                            aria-label="{{ product.title }}"
                          >
                            <div class="product-images-container relative">
                              {% if product.images.size > 1 %}
                                {% for image in product.images %}
                                  <img
                                    srcset="
                                      {%- if image.width >= 165 -%}{{ image | image_url: width: 165 }} 165w,{%- endif -%}
                                      {%- if image.width >= 360 -%}{{ image | image_url: width: 360 }} 360w,{%- endif -%}
                                      {%- if image.width >= 535 -%}{{ image | image_url: width: 535 }} 535w,{%- endif -%}
                                      {%- if image.width >= 750 -%}{{ image | image_url: width: 750 }} 750w,{%- endif -%}
                                      {%- if image.width >= 1070 -%}{{ image | image_url: width: 1070 }} 1070w,{%- endif -%}
                                      {%- if image.width >= 1500 -%}{{ image | image_url: width: 1500 }} 1500w,{%- endif -%}
                                      {{ image | image_url }} {{ image.width }}w
                                    "
                                    src="{{ image | image_url: width: 750, crop: 'center' }}"
                                    alt="{{ product.title }}{% if forloop.index > 1 %} image {{ forloop.index }}{% endif %}"
                                    class="product-image {% if forloop.first %}active{% else %}inactive{% endif %} fc-product-image"
                                    data-index="{{ forloop.index0 }}"
                                    data-product-id="{{ product.id }}"
                                    loading="lazy"
                                    decoding="async"
                                    width="440"
                                    height="530"
                                    style="object-fit: cover;"
                                  >
                                {% endfor %}

                                <button
                                  class="image-nav-arrow image-nav-prev"
                                  data-product-id="{{ product.id }}"
                                  aria-label="Previous image for {{ product.title }}"
                                >
                                  <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    stroke="currentColor"
                                    viewBox="0 0 9 9"
                                  >
                                    <path fill="currentColor" d="M1.1875 7.7334H7.6599M7.6599 7.7334V1.261M7.6599 7.7334L1.1875 1.261"></path>
                                  </svg>
                                </button>
                                <button
                                  class="image-nav-arrow image-nav-next"
                                  data-product-id="{{ product.id }}"
                                  aria-label="Next image for {{ product.title }}"
                                >
                                  <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    stroke="currentColor"
                                    viewBox="0 0 9 9"
                                  >
                                    <path fill="currentColor" d="M1.1875 7.7334H7.6599M7.6599 7.7334V1.261M7.6599 7.7334L1.1875 1.261"></path>
                                  </svg>
                                </button>
                              {% else %}
                                <img
                                  src="{{ product.featured_image | img_url: '440x530', crop: 'center' }}"
                                  alt="{{ product.title }}"
                                  class="fc-product-image"
                                  loading="lazy"
                                  decoding="async"
                                  width="440"
                                  height="530"
                                  style="object-fit: cover;"
                                >
                              {% endif %}
                            </div>
                          </a>

                          <div class="product-cart-container absolute bottom-4 left-1/2 transform -translate-x-1/2 w-full px-4">
                            <div class="cart-options-wrapper relative">
                              {% assign has_size_variants = false %}
                              {% unless product.has_only_default_variant %}
                                {% for option in product.options_with_values %}
                                  {% if option.name == 'Size' or option.name == 'size' %}
                                    {% assign has_size_variants = true %}
                                  {% endif %}
                                {% endfor %}
                              {% endunless %}

                              {% if has_size_variants %}
                                <div
                                  class="size-variants-container p-2 mb-0 opacity-0 invisible"
                                  role="group"
                                  aria-label="Size options for {{ product.title }}"
                                  style="background-color: var(--text);"
                                >
                                  {% for option in product.options_with_values %}
                                    {% if option.name == 'Size' or option.name == 'size' %}
                                      {% assign size_option_index = forloop.index0 %}
                                      <div
                                        class="size-label-wrapper flex items-center w-full"
                                      >
                                        <span
                                          class="size-label text-m px-2 mr-auto"
                                          style="color: rgb(var(--color-background)); background-color: var(--text);"
                                          >SIZE</span
                                        >
                                        <div
                                          class="size-options-wrapper flex flex-wrap gap-4 justify-end"
                                          data-option-index="{{ size_option_index }}"
                                        >
                                          {% for value in option.values %}
                                            {% assign variant_available = false %}
                                            {% for variant in product.variants %}
                                              {% if variant.options[size_option_index] == value and variant.available %}
                                                {% assign variant_available = true %}
                                                {% assign variant_id = variant.id %}
                                                {% break %}
                                              {% endif %}
                                            {% endfor %}

                                            <button
                                              class="size-option-btn p-5 text-s rounded size-animate {% unless variant_available %}unavailable-size{% endunless %}"
                                              {% if variant_available %}
                                                data-variant-id="{{ variant_id }}"
                                                data-product-id="{{ product.id }}"
                                              {% else %}
                                                data-waitlist="true"
                                                data-product-id="{{ product.id }}"
                                                data-product-title="{{ product.title | escape }}"
                                                data-variant-size="{{ value }}"
                                                aria-disabled="true"
                                              {% endif %}
                                              style="--animation-order: {{ forloop.index }}; background-color: var(--text); color: rgb(var(--color-background));"
                                              aria-label="Size {{ value }}{% unless variant_available %} - Sold Out{% endunless %}"
                                              {% unless variant_available %}
                                                aria-disabled="true"
                                              {% endunless %}
                                            >
                                              {{ value }}
                                            </button>
                                          {% endfor %}
                                        </div>
                                      </div>
                                    {% endif %}
                                  {% endfor %}
                                </div>
                              {% endif %}

                              {% if product.available %}
                                <button
                                  class="add-to-cart-btn w-90 text-(--text) py-2 px-4 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300"
                                  style="background-color: rgb(var(--color-background)); color: var(--text);"
                                  data-product-id="{{ product.id }}"
                                  {% if product.has_only_default_variant %}
                                    data-variant-id="{{ product.variants.first.id }}"
                                    data-has-variants="false"
                                  {% elsif has_size_variants %}
                                    data-has-variants="true"
                                  {% else %}
                                    data-variant-id="{{ product.variants.first.id }}"
                                    data-has-variants="false"
                                  {% endif %}
                                  aria-label="Add {{ product.title }} to cart"
                                >
                                  ADD TO CART
                                </button>
                              {% else %}
                                <button
                                  class="notify-me-btn w-90 text-(--text) py-2 px-4 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300"
                                  data-product-id="{{ product.id }}"
                                  data-product-title="{{ product.title | escape }}"
                                  data-has-variants="{% if has_size_variants %}true{% else %}false{% endif %}"
                                  aria-label="Get notified when {{ product.title }} is back in stock"
                                  aria-haspopup="dialog"
                                  style="background-color: rgb(var(--color-background)); color: var(--text);"
                                >
                                  NOTIFY ME WHEN IN STOCK
                                </button>
                              {% endif %}
                            </div>
                          </div>
                        </div>

                        <div class="product-details mt-3" style="margin-bottom:8px;">
                          <a href="{{ product.url }}" aria-label="{{ product.title }}">
                            <h3
                              class="uppercase leading-tight fc-product-title"
                              style="color: var(--text);"
                            >
                              {{ product.title | escape }}
                            </h3>
                            <div
                              id="fc-product-price"
                              class="flex gap-2 items-baseline fc-price"
                              style="color: var(--text);"
                            >
                              <span class="uppercase" style="color: var(--text);">
                                {{ product.price | money }}
                              </span>
                              {%- if product.compare_at_price > product.price -%}
                                <span id="fc-product-dash">|</span>
                                <span class="uppercase text-red-600">
                                  {{- product.compare_at_price | money }} FOR MEMBERS</span
                                >
                              {%- endif -%}
                            </div>
                          </a>
                        </div>
                      </article>
                    {% endfor %}
                  {% endif %}
                </div>
              </div>
            </div>
          {% endif %}
        {% endfor %}
      </main>
    </div>
  </div>

  <div
    id="waitlist-modal-overlay"
    class="fixed inset-0 z-50 bg-(--text) hidden items-center justify-center"
    aria-modal="true"
    aria-labelledby="waitlist-product-title"
    aria-describedby="waitlist-product-variant"
  >
    <div
      class="!w-auto md:!w-[50vw] max-w-[90vw] rounded p-4 md:p-10 shadow-lg mx-4"
      style="background-color: rgb(var(--color-background));"
    >
      <div class="flex justify-end p-2 md:p-4">
        <button
          id="close-waitlist-modal"
          class="text-(--text) hover:text-gray-700 font-medium"
          aria-label="Close waitlist form"
        >
          CLOSE
        </button>
      </div>

      <h2 class="text-xl md:text-2xl font-bold mb-2" id="waitlist-product-title">PRODUCT TITLE</h2>

      <div class="text-gray-600 mb-4" id="waitlist-product-variant">XS / PORT</div>

      <hr class="border-gray-300 mx-2 md:mx-6" aria-hidden="true">

      <div class="my-4 md:my-6">
        <p class="font-medium mb-4 text-sm md:text-base">
          Waitlist: Enter your email to get notified when this product becomes available again.
        </p>

        <div class="flex flex-col sm:flex-row gap-3 mb-4" aria-label="Waitlist notification form">
          <input
            type="email"
            id="waitlist-email"
            placeholder="Your email"
            class="flex-grow border border-gray-300 p-2 md:p-3 rounded text-sm md:text-base"
          >
          <button
            id="get-notified-btn"
            class="bg-(--text) py-2 md:py-3 px-4 md:px-6 font-medium hover:bg-gray-800 rounded text-sm md:text-base"
            aria-label="Submit waitlist request"
            style="color: rgb(var(--color-background));"
          >
            GET NOTIFIED
          </button>
        </div>
      </div>
    </div>
  </div>
{% endif %}

<style>
    .featured-collection-page-width ::selection {
      /* background: none; */
      color: var(--cr-yellow-2) !important;
    }
    .featured-collection-page-width {
      padding: {{ settings.sections_spacing }}px {{ settings.side_space}}px;
      overflow-y: hidden;
    }

    @media (max-width: 749px) {
      /* .featured-collection-page-width {
        margin: 0 8px;
      } */
    }

    .featured-collection-subheading p {
      /* margin-top: -30px; */
      line-height: 1;
    }

    div.featured-collection-main-heading {
      line-height: 80% !important;
      font-size: 48px;
      left: -3px;
    }

    .collection-filters {
      justify-content: center;
    }

    @media (min-width: 500px) {
      div.featured-collection-main-heading {
        font-size: 48px;
      }
    }

    @media (max-width: 500px) {
      .product-image, .fc-product-image, .product-image-wrapper{
        width: 255px !important;
        height: 306px !important;
      }
      .sold-out{
        font-size: 11px !important;
      }
    }

    @media (min-width: 768px) {
      .collections-container {
        width: 400px !important;
        min-width: 350px;
        max-width: 450px;
      }

      div.featured-collection-main-heading {
        padding-top: {{ section.settings.padding_top }}px;
        font-size: 80px;
      }

      .products-container {
        width: calc(100% - 400px - 1.5rem) !important;
        overflow: hidden;
      }

      .slider-container {
        margin-right: -1.5rem;
      }

      .product-slider {
        padding-right: 1.5rem;
      }
    }

    @media (min-width: 900px) {
      div.featured-collection-main-heading {
        font-size: 100px;
      }
    }

    @media (min-width: 1080px) {
      div.featured-collection-main-heading {
        font-size: 120px;
      }
    }

    .sold-out{
      padding: 0px 4px;
      border-radius: {{ settings.buttons_radius |  minus: 2 }}px;
      line-height: 20px;
      display: inline-block;
      font-size: 14px;
      border: 1px solid var(--text);
      color: var(--text);
      background-color: rgb(var(--color-background));
    }

    .collection-filters .collection-btn {
      padding: 0.5rem 1.2rem;
      padding-left: 0;
      border-bottom: 1px solid var(--text);
      text-align: left;
      background: rgb(var(--color-background));
      color: var(--text);
      text-decoration: none;
      transition: all 0.5s ease;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      position: relative;
    }

    .svg-arrow-right {
      opacity: 0;
      transition: opacity 0.5s ease, transform 0.5s ease;
      transform: translateX(-4px);
    }
    .collection-btn:hover .svg-arrow-right,
    .collection-btn.active .svg-arrow-right {
      opacity: 1;
      transform: translateX(0);
    }

    .collection-filters .collection-btn:hover,
    .collection-filters .collection-btn.active {
      background: var(--text);
      color: rgb(var(--color-background));
      border-bottom: 1px solid rgb(var(--color-background));
    }

    .collection-filters .collection-btn.active .featured-collection-arrow-svg{
      opacity: 1;
      fill: var(--background);
      transform: rotate(-90deg);
    }

    .collection-filters .collection-btn:hover .featured-collection-arrow-svg{
      opacity: 1;
      fill: var(--background);
      transform: rotate(-90deg);
    }

    .collection-filters .collection-btn .featured-collection-arrow-svg{
      opacity: 1;
      fill: var(--text);
      /* transform: rotate(45deg); */
    }

    .collection-filters .collection-btn .featured-collection-arrow-svg-only-on-hover{
      opacity: 0;
      transition: transform 0s ease !important;
    }

    .product-image-wrapper {
      position: relative;
      overflow: hidden;
    }

    .product-images-container {
      position: relative;
    }

    /* Updated image transition styles */
    .product-image {
      position: absolute;
      top: 0;
      left: 0;
      opacity: 0;
      /* pointer-events: none; */
      transition: opacity 0.7s ease;
    }

    .product-image.active {
      opacity: 1;
      /* pointer-events: auto; */
      position: relative;
    }

    .fc-price{
        margin-top: -6px !important;
      }

      .product-details .fc-product-title, .product-details .fc-product-price{
        font-size: 13px;
      }

    .image-nav-arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      z-index: 15;
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.5s ease, background-color 0.5s ease;
      cursor: pointer;
      border: none;
    }

    .product-image-wrapper:hover .image-nav-arrow {
      opacity: 0.6;
    }

    .image-nav-arrow:hover {
      background-color: rgba(68, 68, 68, 0.15);
    }

    .product-image-wrapper:hover .image-nav-arrow svg {
      transition: opacity 0.5s ease;
      opacity: 0.6;
    }

    .image-nav-arrow svg{
      opacity: 0;
      width: 15px;
      height: 15px;
    }

    .image-nav-prev svg {
      transform: rotate(135deg);
    }

    .image-nav-next svg {
      transform: rotate(-45deg);
    }

    .image-nav-prev {
      left: 0px;
    }

    .image-nav-next {
      right: 0px;
    }

    .product-cart-container {
      z-index: 10;
      width: 90%;
    }

    .cart-options-wrapper {
      position: relative;
    }

    .add-to-cart-btn,
    .notify-me-btn {
      transition: all 0.5s ease;
      width: 110%;
      left: -5%;
      height: 50px;
      border-radius: {{ settings.buttons_radius }}px;
      font-size: 20px;
      position: relative;
      z-index: 5;
      cursor: pointer;
    }

    .add-to-cart-btn:hover,
    .notify-me-btn:hover {
      background-color: var(--text) !important;
      color: rgb(var(--color-background)) !important;
    }

    .size-variants-container {
      border-radius: {{ settings.buttons_radius }}px;
      position: absolute;
      bottom: 0;
      left: 0;
      width: 110%;
      left: -5%;
      height: 100%;
      z-index: 10;
      transition: all 0.5s ease;
      transform: translateY(0);
      display: flex;
      justify-content: center;
      padding: 5px 10px;
      font-size: 20px;
      background-color: var(--text);
      color: rgb(var(--color-background));
    }

    .size-label-wrapper {
      display: flex;
      width: 110%;
      left: -5%;
      align-items: center;
      border-radius: {{ settings.buttons_radius }}px;
    }

    .size-label {
      margin-right: auto;
      border-radius: {{ settings.buttons_radius }}px;
      color: var(--text);
    }

    .product-cart-container:hover .size-variants-container,
    .size-variants-container.active {
      opacity: 1 !important;
      visibility: visible !important;
      transform: translateY(0);
    }

    .product-cart-container:hover .add-to-cart-btn[data-has-variants='true'] {
      opacity: 0 !important;
      visibility: hidden;
    }

    .product-cart-container:hover .add-to-cart-btn[data-has-variants='false'],
    .product-cart-container:hover .notify-me-btn {
      opacity: 1 !important;
      visibility: visible !important;
    }

    .size-option-btn {
      transition: all 0.4s ease;
      width: 30px;
      height: 30px;
      border-radius: {{ settings.buttons_radius }}px;
      color: rgb(var(--color-background));
      font-size: 18px;
      border: 1.5px solid rgb(var(--color-background));
      padding: 2px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      opacity: 1; /* Ensure buttons are visible */
      visibility: visible; /* Ensure buttons are visible */
      background-color: transparent;
    }

    .size-option-btn:hover {
      transform: translateY(-2px);
      background-color: rgb(var(--color-background)) !important;
      color: var(--text) !important;
    }

    .unavailable-size {
      opacity: 1;
      position: relative;
      cursor: not-allowed;
      border-color: var(--disabled_text) !important;
      color: var(--disabled_text) !important;
      overflow: hidden;
    }

    .unavailable-size:hover{
      background-color: var(--disabled_text) !important;
      color: var(--text);
    }

    .unavailable-size::after {
      content: '';
      position: absolute;
      top: 50%;
      left: -2px;
      right: -2px;
      height: 2px;
      background-color: var(--disabled_text);
      transform: rotate(-45deg);
    }

    .unavailable-size:hover::after{
      height: 0px;
    }

    .size-option-btn:hover {
      transform: translateY(-2px);
    }

    .size-option-btn.size-animate {
      opacity: 1; /* Changed from 0 to 1 */
      transform: translateY(0); /* Changed from translateY(20px) to 0 */
      animation: sizeAppear 0.3s ease forwards;
      animation-delay: calc(0.1s * var(--animation-order));
    }

    @keyframes sizeAppear {
      0% {
        opacity: 0;
        transform: translateY(20px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .size-variants-container:not(.active) .size-option-btn {
      animation: none;
      opacity: 1; /* Changed from 0 to 1 */
      transform: translateY(0); /* Changed from translateY(20px) to 0 */
    }

    .size-variants-container.active .size-option-btn {
      animation: sizeAppear 0.3s ease forwards;
      animation-delay: calc(0.1s * var(--animation-order));
      opacity: 1; /* Ensure visible during animation */
    }

    .shop-all-button {
      display: inline-block;
      text-align: center;
      padding: 2px 5px;
      font-weight: bold;
      background-color: #000;
      color: rgb(var(--color-background));
      text-decoration: none;
      border-radius: {{ settings.buttons_radius |  minus: 1 }}px;
      transition: background-color 0.5s ease;
    }

    .shop-all-button:hover {
      background-color: #555;
    }

    {% if section.settings.uppercase_text %}
      .featured-collection-main-heading {
        text-transform: uppercase !important;
      }
    {% endif %}

    hr {
      border: 0;
      background: #000;
      margin: 0 !important;
    }

    .slider-container {
      position: relative;
      width: 100%;
      overflow-x: auto;
      overflow-y: hidden;
      -webkit-overflow-scrolling: touch;
      height: auto;
      padding-bottom: 24px;
    }

    .product-slider {
      display: flex;
      gap: 18px;
      overflow-y: hidden;
    }

    .product-card {
      flex-shrink: 0;
      height: auto;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      overflow: hidden;
    }

    .product-slider::-webkit-scrollbar:vertical {
      display: none;
    }

    .cursor-grab {
      cursor: grab;
      padding-bottom: 12px;
    }

    .cursor-grabbing {
      cursor: grabbing;
    }

    .custom-scrollbar::-webkit-scrollbar {
      height: 6px;
      background: transparent;
      transform: translateY(-50%);
    }

    .custom-scrollbar::-webkit-scrollbar-track {
      background-color: transparent;
      background-image: linear-gradient(to right, var(--text), var(--text));
      background-size: 100% 1px;
      background-repeat: no-repeat;
      background-position: center;
      border: none;
    }

    .custom-scrollbar::-webkit-scrollbar-thumb {
      background-color: var(--text);
      height: 3px;
      border: none;
      /* border-radius: 4px; */
      margin-top: -1px;
    }

    .custom-scrollbar::-webkit-scrollbar-button:single-button {
      display: none;
      width: 0;
      height: 0;
    }

    #waitlist-modal-overlay {
      transition: opacity 0.5s ease;
    }

    #waitlist-modal-overlay.hidden {
      opacity: 0;
      /* pointer-events: none; */
    }

    #waitlist-product-title {
      text-transform: uppercase;
      font-weight: bold;
    }

    #waitlist-email {
      border: 1px solid #ccc;
    }

    #get-notified-btn {
      white-space: nowrap;
      text-transform: uppercase;
    }

    .product-cart-container:hover .notify-me-btn[data-has-variants='true'] {
      opacity: 0 !important;
      visibility: hidden !important;
    }

    .product-cart-container:hover .size-variants-container {
      opacity: 1 !important;
      visibility: visible !important;
      transform: translateY(0);
    }

    .featured-collection-custom-button {
      position: relative;
      display: inline-block;
      padding: 2px 7px;
      background-color: rgb(var(--color-background));
      color: var(--text);
      border-radius: {{ settings.buttons_radius |  minus: 1 }}px;
      border: var(--text) 1px solid !important;
      overflow: hidden;
      transition: background-color 0.3s, color 0.3s;
    }

    .featured-collection-custom-button:hover {
      background-color: var(--text);
      border: rgb(var(--color-background)) 2px solid;
      color: rgb(var(--color-background));
      border: 2px solid rgb(var(--color-background));
    }

    .featured-collection-button-text-container {
      position: relative;
      width: 100%;
      overflow: hidden;
    }

    .featured-collection-button-text {
      display: flex;
      align-items: center;
      font-size: 24px;
      line-height: 1;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      transition: transform 1s ease;
    }

    .featured-collection-custom-button:hover .featured-collection-button-text {
      transform: translateX(-100%);
    }

    .featured-collection-button-text-hover {
      position: absolute;
      top: 0;
      left: 0;
      display: flex;
      align-items: center;
      font-size: 24px;
      line-height: 1;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      transform: translateX(100%);
      transition: transform 1s ease;
    }

    .featured-collection-custom-button:hover .featured-collection-button-text-hover {
      transform: translateX(0);
    }

    .featured-collection-custom-button:not(:hover) .featured-collection-button-text,
    .featured-collection-custom-button:not(:hover) .featured-collection-button-text-hover {
      transition: none;
    }

    .featured-collection-button-arrow {
      margin-left: 28px;
    }

    .product-image-wrapper {
    position: relative;
    overflow: hidden;
  }
  .product-image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: opacity 0.5s ease-in-out;
    opacity: 0;
    /* pointer-events: none; */
  }
  .product-image.active {
    opacity: 1;
    /* pointer-events: auto; */
  }

  .product-image, .fc-product-image, .product-image-wrapper{
      width: 440px;
      height: 530px;
    }

  @media (max-width: 1025px){
    .product-image, .fc-product-image, .product-image-wrapper{
      width: 350px;
      height: 420px;
    }
  }

    @media (max-width: 768px) {
      .collection-filters {
        gap: 5px;
        justify-content: left;
      }

      .collection-btn {
        padding: 0 6px !important;
        border: none !important;
        border-radius: {{ settings.buttons_radius |  minus: 1 }}px; !important;
        background: rgba(199, 199, 199, 0.9) !important;
        font-size: 12px !important;
        min-width: fit-content !important;
        height: 22px !important;
        text-transform: uppercase;
      }

      #fc-product-dash{
        display: none;
      }

      #fc-product-price{
        flex-direction: column;
        gap: 0;
        line-height: 1.2;
        padding-top: 6px;
      }

      .collection-btn:hover{
        background: var(--text) !important;
      }

      .featured-collection-custom-button{
        padding: 0px 3px;
      }

      .featured-collection-button-text{
        font-size: 14px;
      }

      .featured-collection-button-text-hover{
        font-size: 14px;
      }

      .collection-filters .collection-btn .fc-arrow-img{
        display: none;
      }

      .product-slider {
        gap: 8px;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
      }
      .product-slider::-webkit-scrollbar {
        display: none;
      }

      .slider-container {
        overflow-x: hidden !important;
      }

      .collection-arrow-img{
        display: none !important;
      }

      .featured-collection-main-heading {
        padding-top: {{ section.settings.padding_top }}px;
      }

      .fc-price{
        margin-top: -6px
      }

      .cursor-grab{
        padding-bottom: 0px;
      }

      .featured-collection-subheading {
        /* margin-top: -10px; */
      }

      .collection-btn.active {
        background: var(--text) !important;
        color: rgb(var(--color-background)) !important;
      }

      .collection-btn .svg-arrow-right {
        display: none !important;
      }
      .size-variants-container,
      .product-cart-container,
      .cart-options-wrapper {
        display: none !important;
        opacity: 0 !important;
        visibility: hidden !important;
      }
    }

    @keyframes letterAppear {
      0% {
        transform: translateX(10000%);
        opacity: 0;
      }
      100% {
        transform: translateX(0);
        opacity: 1;
      }
    }
    .letter-animation-container {
      display: inline-block;
      width: 100%;
      overflow: visible;
      position: relative;
    }
    .animated-letter {
      display: inline-block;
      opacity: 0;
      transform: translateX(500%);
      position: relative;
    }

    /* Ensure hidden elements are completely removed from layout */
    .hidden {
      display: none !important;
    }

    /* Make more specific for collection containers */
    .collection-products-container.hidden {
      display: none !important;
      visibility: hidden;
      position: absolute;
      /* pointer-events: none; */
      opacity: 0;
      z-index: -1;
    }
</style>

<script src="{{ 'featured-collection.js' | asset_url }}" defer></script>

{% schema %}
{
  "name": "Featured Collection",
  "tag": "section",
  "class": "section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "checkbox",
      "id": "enabled",
      "label": "Enable section",
      "default": true
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "scheme-1"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Featured Collections"
    },
    {
      "type": "checkbox",
      "id": "enable_letter_animation",
      "label": "Enable letter-by-letter animation for heading",
      "default": false,
      "info": "If enabled, the heading will animate letter by letter when it comes into view."
    },
    {
      "type": "text",
      "id": "description",
      "label": "Description",
      "default": "<p>Browse our featured products</p>"
    },
    {
      "type": "checkbox",
      "id": "show_shop_all",
      "label": "Show 'Shop All' button",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "uppercase_text",
      "label": "Make heading uppercase",
      "default": false,
      "info": "If enabled, heading will be displayed in uppercase."
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button text",
      "default": "SHOP ALL",
      "info": "Text for the 'Shop All' button"
    },
    {
      "type": "collection",
      "id": "main_collection",
      "label": "Main collection for 'Shop All'",
      "info": "Collection to link when 'Shop All' is clicked"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Top Padding",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 15
    },
    {
      "type": "checkbox",
      "id": "arrow_on_hover",
      "label": "Show arrows only on hover",
      "default": false
    }
  ],
  "blocks": [
    {
      "type": "collection",
      "name": "Collection",
      "limit": 10,
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Collection Name",
          "default": "Collection"
        },
        {
          "type": "collection",
          "id": "collection",
          "label": "Collection",
          "info": "Select a collection to display"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Featured Collection",
      "blocks": [
        {
          "type": "collection"
        },
        {
          "type": "collection"
        },
        {
          "type": "collection"
        }
      ]
    }
  ]
}
{% endschema %}
