<link rel="stylesheet" href="{{ 'section-main-blog.css' | asset_url }}">
{{ 'scroll-animations.css' | asset_url | stylesheet_tag }}

<script src="{{ 'scroll-animations.js' | asset_url }}" defer="defer"></script>
 
<div class="blog-grid blog-grid-animated scroll-fade-stagger w-full" id="blog-posts-container">
  {% assign default_blog_handle = 'news' %}
  {% assign blog_handle = section.settings.selected_blog | default: default_blog_handle %}
  {% assign blog = blogs[blog_handle] %}
  {% assign articles_limit = section.settings.articles_per_page %}
  {% assign articles_count = blog.articles.size %}

    <a href="{{ article.url }}" class="{{ article_class }} blog-card-item scroll-fade-trigger scroll-fade-up" data-animation-index="{{ forloop.index0 }}">
      <div class="zoom-trigger">
        <div class="aspect-[5/3] overflow-hidden">
          {% if article.image != blank %}
            <img src="{{ article.image | image_url: width: 600 }}"
                 alt="{{ article.title | default: 'Blog image' | escape }}"
                 width="25vw"
                 height="24.17vw"
                 loading="lazy"
                 class="img1 object-cover transition-transform duration-300 ease-in-out"
                 style="width: 24.9vw; height: auto; max-height: 49.5vh; transform-origin: center center;" />
          {% else %}
            {{ 'collection-1' | placeholder_svg_tag: 'w-full h-full bg-gray' }}
          {% endif %}
        </div>
        <div>
          <p class="text-article-date-color" style="font-family: var(--font-body-family);margin-bottom:2.7vh; margin-top:2.7vh; font-size:var(--t-b-2-size); font-weight:var(--t-b-2-weight); line-height:var(--t-b-2-line-height);">
            {{ article.published_at | date: "%m.%d.%y" }}
          </p>
          <div class="subclass-header" id="article-title-{{ forloop.index0 }}" style="font-family: var(--font-heading-family);font-size:var(--t-h-4-size); font-weight:var(--t-h-4-weight); line-height:var(--t-h-4-line-height);">
            <svg class="w-8 object-contain inline-block"
                 style="height:22px; margin-top:-8px; margin-right:-4px;"
                 viewBox="5.5 2 8.5 13"
                 fill="currentColor"
                 xmlns="http://www.w3.org/2000/svg"
                 stroke="currentColor"
                 aria-hidden="true">
              <path d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"/>
            </svg>
            {{ article.title }}
          </div>
          <span class="subclass-subheader font-medium tracking-tight" style="font-family: var(--font-body-family);font-size:var(--t-b-2-size); font-weight:var(--t-b-2-weight); line-height:var(--t-b-2-line-height);">
            {{ article.content | strip_html | truncate: 50, "" }}
          </span>
        </div>
      </div>
    </a>
</div>

<style>
  /* Blog Article Fade-Up Animations */
  .blog-card-item.scroll-fade-trigger {
    opacity: 0;
    transform: translateY(50px);
    transition: opacity 0.6s ease, transform 0.6s ease;
  }

  .blog-card-item.scroll-fade-trigger.animate {
    opacity: 1;
    transform: translateY(0);
  }

  /* Staggered delays for blog article cards */
  .blog-grid .blog-card-item:nth-child(1) {
    transition-delay: 0s;
  }
  .blog-grid .blog-card-item:nth-child(2) {
    transition-delay: 0.1s;
  }
  .blog-grid .blog-card-item:nth-child(3) {
    transition-delay: 0.2s;
  }
  .blog-grid .blog-card-item:nth-child(4) {
    transition-delay: 0.3s;
  }
  .blog-grid .blog-card-item:nth-child(5) {
    transition-delay: 0.4s;
  }
  .blog-grid .blog-card-item:nth-child(6) {
    transition-delay: 0.5s;
  }
  .blog-grid .blog-card-item:nth-child(7) {
    transition-delay: 0.6s;
  }
  .blog-grid .blog-card-item:nth-child(8) {
    transition-delay: 0.7s;
  }
  .blog-grid .blog-card-item:nth-child(9) {
    transition-delay: 0.8s;
  }
  .blog-grid .blog-card-item:nth-child(10) {
    transition-delay: 0.9s;
  }
  .blog-grid .blog-card-item:nth-child(11) {
    transition-delay: 1.0s;
  }
  .blog-grid .blog-card-item:nth-child(12) {
    transition-delay: 1.1s;
  }

  /* Hover enhancement for animated blog article cards */
  .blog-card-item.animate:hover {
    transform: translateY(-2px);
    transition: transform 0.3s ease;
  }

  @media screen and (max-width: 768px) {
    .blog-card-item.scroll-fade-trigger {
      transform: translateY(30px);
      transition: opacity 0.4s ease, transform 0.4s ease;
    }

    .blog-grid .blog-card-item:nth-child(n) {
      transition-delay: calc(var(--index, 0) * 0.1s);
    }
  }

  /* Accessibility - Respect reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .blog-card-item.scroll-fade-trigger {
      opacity: 1 !important;
      transform: none !important;
      transition: none !important;
    }
  }
</style>

<script>
  // Custom Blog Article Grid Fade-Up Animation
  document.addEventListener('DOMContentLoaded', function() {
    const blogGrid = document.querySelector('.blog-grid');
    if (!blogGrid) return;

    const blogCards = blogGrid.querySelectorAll('.blog-card-item');

    // Set initial state for all cards
    blogCards.forEach((card, index) => {
      card.style.opacity = '0';
      card.style.transform = 'translateY(50px)';
      card.style.transition = `opacity 0.6s ease ${index * 0.1}s, transform 0.6s ease ${index * 0.1}s`;
    });

    // Create intersection observer
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          // Trigger fade-up animation
          entry.target.style.opacity = '1';
          entry.target.style.transform = 'translateY(0)';

          // Stop observing this element
          observer.unobserve(entry.target);
        }
      });
    }, {
      rootMargin: '0px 0px -100px 0px',
      threshold: 0.1
    });

    // Observe all blog cards
    blogCards.forEach(card => {
      observer.observe(card);
    });
  });
</script>
